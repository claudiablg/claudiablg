'use strict';
var __importDefault =
  (this && this.__importDefault) ||
  function (mod) {
    return mod && mod.__esModule ? mod : { default: mod };
  };
Object.defineProperty(exports, '__esModule', { value: true });
exports.onPreBootstrap = exports.createPages = exports.onCreateWebpackConfig = exports.onCreateBabelConfig = void 0;
const child_process_1 = require('child_process');
const core_utils_1 = require('@newrade/core-utils');
const webpack_config_1 = require('./webpack.config');
const chalk_1 = __importDefault(require('chalk'));
/**
 * Gatsby Node Configuration
 *
 * @see https://www.gatsbyjs.com/docs/node-apis/
 */
require('dotenv').config();
exports.onCreateBabelConfig = ({ actions }) => {
  actions.setBabelPlugin({
    name: 'babel-plugin-treat',
    options: {},
  });
};
exports.onCreateWebpackConfig = ({ stage, rules, loaders, plugins, actions }) => {
  const isProduction = stage !== `develop`;
  const isSSR = stage.includes(`html`);
  actions.setWebpackConfig(
    webpack_config_1.createGatsbyWebpackConfig({ isProduction, stage, isSSR, loaders, plugins })
  );
};
exports.createPages = async ({ graphql, actions }) => {
  const { createPage, createRedirect } = actions;
  createRedirect({ fromPath: '/employeur-en-personnel-specialise/', toPath: '/employeurs/', isPermanent: true });
  createRedirect({ fromPath: '/division-secteur-industriel/', toPath: '/employeurs/', isPermanent: true });
  createRedirect({ fromPath: '/division-entreprises-de-services/', toPath: '/employeurs/', isPermanent: true });
  createRedirect({ fromPath: '/division-construction/', toPath: '/employeurs/', isPermanent: true });
  createRedirect({
    fromPath: '/candidats-recrutement-personnel-specialise/',
    toPath: '/candidats/',
    isPermanent: true,
  });
  createRedirect({
    fromPath: '/coordonnees/',
    toPath: '/nous-joindre/',
    isPermanent: true,
  });
};
// export const onCreateNode: GatsbyNode['onCreateNode'] = async ({
//   node,
//   actions,
//   store,
//   cache,
//   reporter,
//   createNodeId,
// }) => {
//   if (node.internal.type === 'Image') {
//     const { createNode } = actions;
//     /* Download the image and create the File node. Using gatsby-plugin-sharp and gatsby-transformer-sharp the node will become an ImageSharp. */
//     const fileNode = await createRemoteFileNode({
//       url: (node as any).url, // string that points to the URL of the image
//       parentNodeId: node.id, // id of the parent node of the fileNode you are going to create
//       store, // Gatsby's redux store
//       cache, // get Gatsby's cache
//       reporter,
//       createNode, // helper function in gatsby-node to generate the node
//       createNodeId, // helper function in gatsby-node to generate the node id
//     });
//     if (fileNode) {
//       // link the File node to Image node at field image
//       (node as any).image___NODE = fileNode.id;
//     }
//   }
// };
exports.onPreBootstrap = (args, options, callback) => {
  core_utils_1.log(`GATSBY_ENABLE_INCREMENTAL_BUILD is set to "${process.env.GATSBY_ENABLE_INCREMENTAL_BUILD}"`, {
    toolName: 'mir-website',
  });
  if (process.env.GATSBY_ENABLE_INCREMENTAL_BUILD !== 'true') {
    callback(null);
    return;
  }
  core_utils_1.log(`rebuilding core-* packages for gatsby cloud's incremental build`, {
    toolName: 'mir-website',
  });
  const cwd = child_process_1.spawn(`yarn postinstall`, {
    cwd: '../..',
    shell: true,
    env: process.env,
  });
  cwd.stdout.on('data', (data) => {
    core_utils_1.log(`${data}`, {
      toolName: 'mir-website',
    });
  });
  cwd.stdout.on('error', (data) => {
    core_utils_1.log(`rebuilding core-* packages: ${chalk_1.default.green('error')}`, {
      toolName: 'mir-website',
      level: core_utils_1.LOG_LEVEL.ERROR,
    });
    core_utils_1.log(data?.message, {
      toolName: 'mir-website',
      level: core_utils_1.LOG_LEVEL.ERROR,
    });
    callback(data);
  });
  cwd.on('close', (code) => {
    core_utils_1.log(`rebuilding core-* packages: ${chalk_1.default.green('done')}`, {
      toolName: 'mir-website',
    });
    callback(null);
  });
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2F0c2J5LW5vZGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJnYXRzYnktbm9kZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxpREFBaUQ7QUFJakQsb0RBQXFEO0FBQ3JELHFEQUE2RDtBQUM3RCxrREFBMEI7QUFFMUI7Ozs7R0FJRztBQUVILE9BQU8sQ0FBQyxRQUFRLENBQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQztBQUVkLFFBQUEsbUJBQW1CLEdBQXNDLENBQUMsRUFBRSxPQUFPLEVBQUUsRUFBRSxFQUFFO0lBQ3BGLE9BQU8sQ0FBQyxjQUFjLENBQUM7UUFDckIsSUFBSSxFQUFFLG9CQUFvQjtRQUMxQixPQUFPLEVBQUUsRUFBRTtLQUNaLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQztBQUVXLFFBQUEscUJBQXFCLEdBQXdDLENBQUMsRUFDekUsS0FBSyxFQUNMLEtBQUssRUFDTCxPQUFPLEVBQ1AsT0FBTyxFQUNQLE9BQU8sR0FDUixFQUFFLEVBQUU7SUFDSCxNQUFNLFlBQVksR0FBRyxLQUFLLEtBQUssU0FBUyxDQUFDO0lBQ3pDLE1BQU0sS0FBSyxHQUFHLEtBQUssQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDckMsT0FBTyxDQUFDLGdCQUFnQixDQUFDLDBDQUF5QixDQUFDLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsT0FBTyxFQUFFLE9BQU8sRUFBRSxDQUFDLENBQUMsQ0FBQztBQUN4RyxDQUFDLENBQUM7QUFFVyxRQUFBLFdBQVcsR0FBOEIsS0FBSyxFQUFFLEVBQUUsT0FBTyxFQUFFLE9BQU8sRUFBRSxFQUFFLEVBQUU7SUFDbkYsTUFBTSxFQUFFLFVBQVUsRUFBRSxjQUFjLEVBQUUsR0FBRyxPQUFPLENBQUM7SUFFL0MsY0FBYyxDQUFDLEVBQUUsUUFBUSxFQUFFLHFDQUFxQyxFQUFFLE1BQU0sRUFBRSxjQUFjLEVBQUUsV0FBVyxFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7SUFDL0csY0FBYyxDQUFDLEVBQUUsUUFBUSxFQUFFLCtCQUErQixFQUFFLE1BQU0sRUFBRSxjQUFjLEVBQUUsV0FBVyxFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7SUFDekcsY0FBYyxDQUFDLEVBQUUsUUFBUSxFQUFFLG9DQUFvQyxFQUFFLE1BQU0sRUFBRSxjQUFjLEVBQUUsV0FBVyxFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7SUFDOUcsY0FBYyxDQUFDLEVBQUUsUUFBUSxFQUFFLHlCQUF5QixFQUFFLE1BQU0sRUFBRSxjQUFjLEVBQUUsV0FBVyxFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7SUFDbkcsY0FBYyxDQUFDO1FBQ2IsUUFBUSxFQUFFLDhDQUE4QztRQUN4RCxNQUFNLEVBQUUsYUFBYTtRQUNyQixXQUFXLEVBQUUsSUFBSTtLQUNsQixDQUFDLENBQUM7SUFDSCxjQUFjLENBQUM7UUFDYixRQUFRLEVBQUUsZUFBZTtRQUN6QixNQUFNLEVBQUUsZ0JBQWdCO1FBQ3hCLFdBQVcsRUFBRSxJQUFJO0tBQ2xCLENBQUMsQ0FBQztBQWdITCxDQUFDLENBQUM7QUFFRixtRUFBbUU7QUFDbkUsVUFBVTtBQUNWLGFBQWE7QUFDYixXQUFXO0FBQ1gsV0FBVztBQUNYLGNBQWM7QUFDZCxrQkFBa0I7QUFDbEIsVUFBVTtBQUNWLDBDQUEwQztBQUMxQyxzQ0FBc0M7QUFFdEMsb0pBQW9KO0FBRXBKLG9EQUFvRDtBQUNwRCw4RUFBOEU7QUFDOUUsZ0dBQWdHO0FBQ2hHLHVDQUF1QztBQUN2QyxxQ0FBcUM7QUFDckMsa0JBQWtCO0FBQ2xCLDJFQUEyRTtBQUMzRSxnRkFBZ0Y7QUFDaEYsVUFBVTtBQUVWLHNCQUFzQjtBQUN0QiwyREFBMkQ7QUFDM0Qsa0RBQWtEO0FBQ2xELFFBQVE7QUFDUixNQUFNO0FBQ04sS0FBSztBQUVRLFFBQUEsY0FBYyxHQUFpQyxDQUFDLElBQUksRUFBRSxPQUFPLEVBQUUsUUFBUSxFQUFFLEVBQUU7SUFDdEYsZ0JBQUcsQ0FBQyw4Q0FBOEMsT0FBTyxDQUFDLEdBQUcsQ0FBQywrQkFBK0IsR0FBRyxFQUFFO1FBQ2hHLFFBQVEsRUFBRSxhQUFhO0tBQ3hCLENBQUMsQ0FBQztJQUVILElBQUksT0FBTyxDQUFDLEdBQUcsQ0FBQywrQkFBK0IsS0FBSyxNQUFNLEVBQUU7UUFDMUQsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ2YsT0FBTztLQUNSO0lBRUQsZ0JBQUcsQ0FBQyxpRUFBaUUsRUFBRTtRQUNyRSxRQUFRLEVBQUUsYUFBYTtLQUN4QixDQUFDLENBQUM7SUFFSCxNQUFNLEdBQUcsR0FBRyxxQkFBSyxDQUFDLGtCQUFrQixFQUFFO1FBQ3BDLEdBQUcsRUFBRSxPQUFPO1FBQ1osS0FBSyxFQUFFLElBQUk7UUFDWCxHQUFHLEVBQUUsT0FBTyxDQUFDLEdBQUc7S0FDakIsQ0FBQyxDQUFDO0lBRUgsR0FBRyxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsTUFBTSxFQUFFLENBQUMsSUFBSSxFQUFFLEVBQUU7UUFDN0IsZ0JBQUcsQ0FBQyxHQUFHLElBQUksRUFBRSxFQUFFO1lBQ2IsUUFBUSxFQUFFLGFBQWE7U0FDeEIsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxHQUFHLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxJQUFJLEVBQUUsRUFBRTtRQUM5QixnQkFBRyxDQUFDLCtCQUErQixlQUFLLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxFQUFFLEVBQUU7WUFDekQsUUFBUSxFQUFFLGFBQWE7WUFDdkIsS0FBSyxFQUFFLHNCQUFTLENBQUMsS0FBSztTQUN2QixDQUFDLENBQUM7UUFDSCxnQkFBRyxDQUFDLElBQUksRUFBRSxPQUFPLEVBQUU7WUFDakIsUUFBUSxFQUFFLGFBQWE7WUFDdkIsS0FBSyxFQUFFLHNCQUFTLENBQUMsS0FBSztTQUN2QixDQUFDLENBQUM7UUFDSCxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDakIsQ0FBQyxDQUFDLENBQUM7SUFFSCxHQUFHLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRSxDQUFDLElBQUksRUFBRSxFQUFFO1FBQ3ZCLGdCQUFHLENBQUMsK0JBQStCLGVBQUssQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLEVBQUUsRUFBRTtZQUN4RCxRQUFRLEVBQUUsYUFBYTtTQUN4QixDQUFDLENBQUM7UUFDSCxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDakIsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBzcGF3blN5bmMsIHNwYXduIH0gZnJvbSAnY2hpbGRfcHJvY2Vzcyc7XG5pbXBvcnQgY3J5cHRvIGZyb20gJ2NyeXB0byc7XG5pbXBvcnQgeyBHYXRzYnlOb2RlIH0gZnJvbSAnZ2F0c2J5JztcbmltcG9ydCB7IGNyZWF0ZVJlbW90ZUZpbGVOb2RlIH0gZnJvbSAnZ2F0c2J5LXNvdXJjZS1maWxlc3lzdGVtJztcbmltcG9ydCB7IGxvZywgTE9HX0xFVkVMIH0gZnJvbSAnQG5ld3JhZGUvY29yZS11dGlscyc7XG5pbXBvcnQgeyBjcmVhdGVHYXRzYnlXZWJwYWNrQ29uZmlnIH0gZnJvbSAnLi93ZWJwYWNrLmNvbmZpZyc7XG5pbXBvcnQgY2hhbGsgZnJvbSAnY2hhbGsnO1xuXG4vKipcbiAqIEdhdHNieSBOb2RlIENvbmZpZ3VyYXRpb25cbiAqXG4gKiBAc2VlIGh0dHBzOi8vd3d3LmdhdHNieWpzLmNvbS9kb2NzL25vZGUtYXBpcy9cbiAqL1xuXG5yZXF1aXJlKCdkb3RlbnYnKS5jb25maWcoKTtcblxuZXhwb3J0IGNvbnN0IG9uQ3JlYXRlQmFiZWxDb25maWc6IEdhdHNieU5vZGVbJ29uQ3JlYXRlQmFiZWxDb25maWcnXSA9ICh7IGFjdGlvbnMgfSkgPT4ge1xuICBhY3Rpb25zLnNldEJhYmVsUGx1Z2luKHtcbiAgICBuYW1lOiAnYmFiZWwtcGx1Z2luLXRyZWF0JyxcbiAgICBvcHRpb25zOiB7fSxcbiAgfSk7XG59O1xuXG5leHBvcnQgY29uc3Qgb25DcmVhdGVXZWJwYWNrQ29uZmlnOiBHYXRzYnlOb2RlWydvbkNyZWF0ZVdlYnBhY2tDb25maWcnXSA9ICh7XG4gIHN0YWdlLFxuICBydWxlcyxcbiAgbG9hZGVycyxcbiAgcGx1Z2lucyxcbiAgYWN0aW9ucyxcbn0pID0+IHtcbiAgY29uc3QgaXNQcm9kdWN0aW9uID0gc3RhZ2UgIT09IGBkZXZlbG9wYDtcbiAgY29uc3QgaXNTU1IgPSBzdGFnZS5pbmNsdWRlcyhgaHRtbGApO1xuICBhY3Rpb25zLnNldFdlYnBhY2tDb25maWcoY3JlYXRlR2F0c2J5V2VicGFja0NvbmZpZyh7IGlzUHJvZHVjdGlvbiwgc3RhZ2UsIGlzU1NSLCBsb2FkZXJzLCBwbHVnaW5zIH0pKTtcbn07XG5cbmV4cG9ydCBjb25zdCBjcmVhdGVQYWdlczogR2F0c2J5Tm9kZVsnY3JlYXRlUGFnZXMnXSA9IGFzeW5jICh7IGdyYXBocWwsIGFjdGlvbnMgfSkgPT4ge1xuICBjb25zdCB7IGNyZWF0ZVBhZ2UsIGNyZWF0ZVJlZGlyZWN0IH0gPSBhY3Rpb25zO1xuXG4gIGNyZWF0ZVJlZGlyZWN0KHsgZnJvbVBhdGg6ICcvZW1wbG95ZXVyLWVuLXBlcnNvbm5lbC1zcGVjaWFsaXNlLycsIHRvUGF0aDogJy9lbXBsb3lldXJzLycsIGlzUGVybWFuZW50OiB0cnVlIH0pO1xuICBjcmVhdGVSZWRpcmVjdCh7IGZyb21QYXRoOiAnL2RpdmlzaW9uLXNlY3RldXItaW5kdXN0cmllbC8nLCB0b1BhdGg6ICcvZW1wbG95ZXVycy8nLCBpc1Blcm1hbmVudDogdHJ1ZSB9KTtcbiAgY3JlYXRlUmVkaXJlY3QoeyBmcm9tUGF0aDogJy9kaXZpc2lvbi1lbnRyZXByaXNlcy1kZS1zZXJ2aWNlcy8nLCB0b1BhdGg6ICcvZW1wbG95ZXVycy8nLCBpc1Blcm1hbmVudDogdHJ1ZSB9KTtcbiAgY3JlYXRlUmVkaXJlY3QoeyBmcm9tUGF0aDogJy9kaXZpc2lvbi1jb25zdHJ1Y3Rpb24vJywgdG9QYXRoOiAnL2VtcGxveWV1cnMvJywgaXNQZXJtYW5lbnQ6IHRydWUgfSk7XG4gIGNyZWF0ZVJlZGlyZWN0KHtcbiAgICBmcm9tUGF0aDogJy9jYW5kaWRhdHMtcmVjcnV0ZW1lbnQtcGVyc29ubmVsLXNwZWNpYWxpc2UvJyxcbiAgICB0b1BhdGg6ICcvY2FuZGlkYXRzLycsXG4gICAgaXNQZXJtYW5lbnQ6IHRydWUsXG4gIH0pO1xuICBjcmVhdGVSZWRpcmVjdCh7XG4gICAgZnJvbVBhdGg6ICcvY29vcmRvbm5lZXMvJyxcbiAgICB0b1BhdGg6ICcvbm91cy1qb2luZHJlLycsXG4gICAgaXNQZXJtYW5lbnQ6IHRydWUsXG4gIH0pO1xuXG4gIC8vIGNvbnN0IGJsb2dQYWdlUXVlcnkgPSBhd2FpdCBncmFwaHFsKGBcbiAgLy8gICBxdWVyeSBCbG9nUG9zdFBhZ2Uge1xuICAvLyAgICAgc2l0ZSB7XG4gIC8vICAgICAgIHNpdGVNZXRhZGF0YSB7XG4gIC8vICAgICAgICAgc2l0ZVVybFxuICAvLyAgICAgICAgIGxhbmd1YWdlcyB7XG4gIC8vICAgICAgICAgICBkZWZhdWx0TGFuZ0tleVxuICAvLyAgICAgICAgICAgbGFuZ3NcbiAgLy8gICAgICAgICB9XG4gIC8vICAgICAgIH1cbiAgLy8gICAgIH1cbiAgLy8gICAgIGdjbXMge1xuICAvLyAgICAgICBjb21wYW55SW5mb3MoZmlyc3Q6IDEpIHtcbiAgLy8gICAgICAgICBjb21wYW55TmFtZVxuICAvLyAgICAgICAgIGxpbmtlZGluUGFnZVVybFxuICAvLyAgICAgICAgIGZhY2Vib29rUGFnZVVybFxuICAvLyAgICAgICAgIGluc3RhZ3JhbVBhZ2VVcmxcbiAgLy8gICAgICAgICB0d2l0dGVyUGFnZVVybFxuICAvLyAgICAgICAgIGxvZ28ge1xuICAvLyAgICAgICAgICAgZmlsZU5hbWVcbiAgLy8gICAgICAgICAgIHVybFxuICAvLyAgICAgICAgIH1cbiAgLy8gICAgICAgICBsb2dvRm9vdGVyIHtcbiAgLy8gICAgICAgICAgIGZpbGVOYW1lXG4gIC8vICAgICAgICAgICB1cmxcbiAgLy8gICAgICAgICB9XG4gIC8vICAgICAgICAgbWV0YWRhdGFUd2l0dGVyXG4gIC8vICAgICAgICAgbWV0YWRhdGFUd2l0dGVyQ3JlYXRvclxuICAvLyAgICAgICAgIG1ldGFkYXRhU2l0ZU5hbWVcbiAgLy8gICAgICAgfVxuICAvLyAgICAgICBwYWdlcyh3aGVyZTogeyBuYW1lOiBcIkJsb2dcIiB9LCBsb2NhbGVzOiBbZnIsIGVuXSkge1xuICAvLyAgICAgICAgIGFjdGlvblNlY3Rpb25zIHtcbiAgLy8gICAgICAgICAgIHR5cGVcbiAgLy8gICAgICAgICAgIHRpdGxlXG4gIC8vICAgICAgICAgICB0aXRsZUhpZ2hsaWdodFxuICAvLyAgICAgICAgICAgc3VidGl0bGVcbiAgLy8gICAgICAgICAgIGFjdGlvblRleHQgIyB0byByZW1vdmVcbiAgLy8gICAgICAgICAgIGxpbmsge1xuICAvLyAgICAgICAgICAgICBuYW1lXG4gIC8vICAgICAgICAgICAgIGxhYmVsXG4gIC8vICAgICAgICAgICAgIHR5cGVcbiAgLy8gICAgICAgICAgICAgdXJsXG4gIC8vICAgICAgICAgICAgIHBhZ2Uge1xuICAvLyAgICAgICAgICAgICAgIHJvdXRlXG4gIC8vICAgICAgICAgICAgIH1cbiAgLy8gICAgICAgICAgIH1cbiAgLy8gICAgICAgICB9XG4gIC8vICAgICAgIH1cbiAgLy8gICAgICAgYmxvZ1Bvc3RzIHtcbiAgLy8gICAgICAgICBpZFxuICAvLyAgICAgICAgIHRpdGxlXG4gIC8vICAgICAgIH1cbiAgLy8gICAgICAgcm91dGVzOiBwYWdlcyh3aGVyZTogeyBOT1Q6IHsgbmFtZTogXCJOb3QgRm91bmRcIiB9IH0sIGxvY2FsZXM6IFtmciwgZW5dKSB7XG4gIC8vICAgICAgICAgbmFtZVxuICAvLyAgICAgICAgIHRpdGxlXG4gIC8vICAgICAgICAgcm91dGVcbiAgLy8gICAgICAgfVxuICAvLyAgICAgfVxuICAvLyAgICAgYmFubmVySW1hZ2VNb2JpbGU6IGZpbGUobmFtZTogeyBlcTogXCJCYW5uZXItTmV3V2Vic2l0ZVwiIH0pIHtcbiAgLy8gICAgICAgaWRcbiAgLy8gICAgICAgY2hpbGRJbWFnZVNoYXJwIHtcbiAgLy8gICAgICAgICAjIGh0dHBzOi8vZ2l0aHViLmNvbS9nYXRzYnlqcy9nYXRzYnkvYmxvYi9tYXN0ZXIvcGFja2FnZXMvZ2F0c2J5LXRyYW5zZm9ybWVyLXNoYXJwL3NyYy9mcmFnbWVudHMuanNcbiAgLy8gICAgICAgICBmbHVpZChxdWFsaXR5OiA5MCwgbWF4V2lkdGg6IDgwMCkge1xuICAvLyAgICAgICAgICAgYmFzZTY0XG4gIC8vICAgICAgICAgICBhc3BlY3RSYXRpb1xuICAvLyAgICAgICAgICAgc3JjXG4gIC8vICAgICAgICAgICBzcmNTZXRcbiAgLy8gICAgICAgICAgIHNyY1dlYnBcbiAgLy8gICAgICAgICAgIHNyY1NldFdlYnBcbiAgLy8gICAgICAgICAgIHNpemVzXG4gIC8vICAgICAgICAgfVxuICAvLyAgICAgICB9XG4gIC8vICAgICB9XG4gIC8vICAgICBiYW5uZXJJbWFnZURlc2t0b3A6IGZpbGUobmFtZTogeyBlcTogXCJCYW5uZXItTmV3V2Vic2l0ZVwiIH0pIHtcbiAgLy8gICAgICAgaWRcbiAgLy8gICAgICAgY2hpbGRJbWFnZVNoYXJwIHtcbiAgLy8gICAgICAgICAjIGh0dHBzOi8vZ2l0aHViLmNvbS9nYXRzYnlqcy9nYXRzYnkvYmxvYi9tYXN0ZXIvcGFja2FnZXMvZ2F0c2J5LXRyYW5zZm9ybWVyLXNoYXJwL3NyYy9mcmFnbWVudHMuanNcbiAgLy8gICAgICAgICBmbHVpZChxdWFsaXR5OiA5MCwgbWF4V2lkdGg6IDE5MjApIHtcbiAgLy8gICAgICAgICAgIGJhc2U2NFxuICAvLyAgICAgICAgICAgYXNwZWN0UmF0aW9cbiAgLy8gICAgICAgICAgIHNyY1xuICAvLyAgICAgICAgICAgc3JjU2V0XG4gIC8vICAgICAgICAgICBzcmNXZWJwXG4gIC8vICAgICAgICAgICBzcmNTZXRXZWJwXG4gIC8vICAgICAgICAgICBzaXplc1xuICAvLyAgICAgICAgIH1cbiAgLy8gICAgICAgfVxuICAvLyAgICAgfVxuICAvLyAgICAgbGlua2VkSW5CYW5uZXI6IGZpbGUobmFtZTogeyBlcTogXCJCYW5uZXItTmV3V2Vic2l0ZVwiIH0pIHtcbiAgLy8gICAgICAgaWRcbiAgLy8gICAgICAgY2hpbGRJbWFnZVNoYXJwIHtcbiAgLy8gICAgICAgICBmaXhlZCh3aWR0aDogMTIwMCwgaGVpZ2h0OiA2MjgpIHtcbiAgLy8gICAgICAgICAgIGJhc2U2NFxuICAvLyAgICAgICAgICAgYXNwZWN0UmF0aW9cbiAgLy8gICAgICAgICAgIHNyY1xuICAvLyAgICAgICAgICAgc3JjU2V0XG4gIC8vICAgICAgICAgICBzcmNXZWJwXG4gIC8vICAgICAgICAgICBzcmNTZXRXZWJwXG4gIC8vICAgICAgICAgfVxuICAvLyAgICAgICB9XG4gIC8vICAgICB9XG4gIC8vICAgfVxuICAvLyBgKTtcblxuICB0eXBlIFBhZ2VDb25maWcgPSB7XG4gICAgbmFtZTogc3RyaW5nO1xuICAgIHRlbXBsYXRlUGF0aDogc3RyaW5nO1xuICAgIHBhdGg6IHN0cmluZztcbiAgICBsYW5nOiAnZW4nIHwgJ2ZyJztcbiAgfTtcbn07XG5cbi8vIGV4cG9ydCBjb25zdCBvbkNyZWF0ZU5vZGU6IEdhdHNieU5vZGVbJ29uQ3JlYXRlTm9kZSddID0gYXN5bmMgKHtcbi8vICAgbm9kZSxcbi8vICAgYWN0aW9ucyxcbi8vICAgc3RvcmUsXG4vLyAgIGNhY2hlLFxuLy8gICByZXBvcnRlcixcbi8vICAgY3JlYXRlTm9kZUlkLFxuLy8gfSkgPT4ge1xuLy8gICBpZiAobm9kZS5pbnRlcm5hbC50eXBlID09PSAnSW1hZ2UnKSB7XG4vLyAgICAgY29uc3QgeyBjcmVhdGVOb2RlIH0gPSBhY3Rpb25zO1xuXG4vLyAgICAgLyogRG93bmxvYWQgdGhlIGltYWdlIGFuZCBjcmVhdGUgdGhlIEZpbGUgbm9kZS4gVXNpbmcgZ2F0c2J5LXBsdWdpbi1zaGFycCBhbmQgZ2F0c2J5LXRyYW5zZm9ybWVyLXNoYXJwIHRoZSBub2RlIHdpbGwgYmVjb21lIGFuIEltYWdlU2hhcnAuICovXG5cbi8vICAgICBjb25zdCBmaWxlTm9kZSA9IGF3YWl0IGNyZWF0ZVJlbW90ZUZpbGVOb2RlKHtcbi8vICAgICAgIHVybDogKG5vZGUgYXMgYW55KS51cmwsIC8vIHN0cmluZyB0aGF0IHBvaW50cyB0byB0aGUgVVJMIG9mIHRoZSBpbWFnZVxuLy8gICAgICAgcGFyZW50Tm9kZUlkOiBub2RlLmlkLCAvLyBpZCBvZiB0aGUgcGFyZW50IG5vZGUgb2YgdGhlIGZpbGVOb2RlIHlvdSBhcmUgZ29pbmcgdG8gY3JlYXRlXG4vLyAgICAgICBzdG9yZSwgLy8gR2F0c2J5J3MgcmVkdXggc3RvcmVcbi8vICAgICAgIGNhY2hlLCAvLyBnZXQgR2F0c2J5J3MgY2FjaGVcbi8vICAgICAgIHJlcG9ydGVyLFxuLy8gICAgICAgY3JlYXRlTm9kZSwgLy8gaGVscGVyIGZ1bmN0aW9uIGluIGdhdHNieS1ub2RlIHRvIGdlbmVyYXRlIHRoZSBub2RlXG4vLyAgICAgICBjcmVhdGVOb2RlSWQsIC8vIGhlbHBlciBmdW5jdGlvbiBpbiBnYXRzYnktbm9kZSB0byBnZW5lcmF0ZSB0aGUgbm9kZSBpZFxuLy8gICAgIH0pO1xuXG4vLyAgICAgaWYgKGZpbGVOb2RlKSB7XG4vLyAgICAgICAvLyBsaW5rIHRoZSBGaWxlIG5vZGUgdG8gSW1hZ2Ugbm9kZSBhdCBmaWVsZCBpbWFnZVxuLy8gICAgICAgKG5vZGUgYXMgYW55KS5pbWFnZV9fX05PREUgPSBmaWxlTm9kZS5pZDtcbi8vICAgICB9XG4vLyAgIH1cbi8vIH07XG5cbmV4cG9ydCBjb25zdCBvblByZUJvb3RzdHJhcDogR2F0c2J5Tm9kZVsnb25QcmVCb290c3RyYXAnXSA9IChhcmdzLCBvcHRpb25zLCBjYWxsYmFjaykgPT4ge1xuICBsb2coYEdBVFNCWV9FTkFCTEVfSU5DUkVNRU5UQUxfQlVJTEQgaXMgc2V0IHRvIFwiJHtwcm9jZXNzLmVudi5HQVRTQllfRU5BQkxFX0lOQ1JFTUVOVEFMX0JVSUxEfVwiYCwge1xuICAgIHRvb2xOYW1lOiAnbWlyLXdlYnNpdGUnLFxuICB9KTtcblxuICBpZiAocHJvY2Vzcy5lbnYuR0FUU0JZX0VOQUJMRV9JTkNSRU1FTlRBTF9CVUlMRCAhPT0gJ3RydWUnKSB7XG4gICAgY2FsbGJhY2sobnVsbCk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgbG9nKGByZWJ1aWxkaW5nIGNvcmUtKiBwYWNrYWdlcyBmb3IgZ2F0c2J5IGNsb3VkJ3MgaW5jcmVtZW50YWwgYnVpbGRgLCB7XG4gICAgdG9vbE5hbWU6ICdtaXItd2Vic2l0ZScsXG4gIH0pO1xuXG4gIGNvbnN0IGN3ZCA9IHNwYXduKGB5YXJuIHBvc3RpbnN0YWxsYCwge1xuICAgIGN3ZDogJy4uLy4uJyxcbiAgICBzaGVsbDogdHJ1ZSxcbiAgICBlbnY6IHByb2Nlc3MuZW52LFxuICB9KTtcblxuICBjd2Quc3Rkb3V0Lm9uKCdkYXRhJywgKGRhdGEpID0+IHtcbiAgICBsb2coYCR7ZGF0YX1gLCB7XG4gICAgICB0b29sTmFtZTogJ21pci13ZWJzaXRlJyxcbiAgICB9KTtcbiAgfSk7XG5cbiAgY3dkLnN0ZG91dC5vbignZXJyb3InLCAoZGF0YSkgPT4ge1xuICAgIGxvZyhgcmVidWlsZGluZyBjb3JlLSogcGFja2FnZXM6ICR7Y2hhbGsuZ3JlZW4oJ2Vycm9yJyl9YCwge1xuICAgICAgdG9vbE5hbWU6ICdtaXItd2Vic2l0ZScsXG4gICAgICBsZXZlbDogTE9HX0xFVkVMLkVSUk9SLFxuICAgIH0pO1xuICAgIGxvZyhkYXRhPy5tZXNzYWdlLCB7XG4gICAgICB0b29sTmFtZTogJ21pci13ZWJzaXRlJyxcbiAgICAgIGxldmVsOiBMT0dfTEVWRUwuRVJST1IsXG4gICAgfSk7XG4gICAgY2FsbGJhY2soZGF0YSk7XG4gIH0pO1xuXG4gIGN3ZC5vbignY2xvc2UnLCAoY29kZSkgPT4ge1xuICAgIGxvZyhgcmVidWlsZGluZyBjb3JlLSogcGFja2FnZXM6ICR7Y2hhbGsuZ3JlZW4oJ2RvbmUnKX1gLCB7XG4gICAgICB0b29sTmFtZTogJ21pci13ZWJzaXRlJyxcbiAgICB9KTtcbiAgICBjYWxsYmFjayhudWxsKTtcbiAgfSk7XG59O1xuIl19
